(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"2LlD":function(e,t,c){"use strict";c.r(t);var n=c("ofXK"),i=c("tyNb"),o=c("wd/R"),r=c("PSD3"),s=c.n(r),a=c("fXoL"),l=c("nwg1"),d=c("rwBg"),h=c("f4UJ"),u=c("AXIP"),b=c("3Pt+");const p=["closeEditModal"];function g(e,t){if(1&e&&(a.ac(0),a.cc(1,"option",21),a.Lc(2),a.bc(),a.Zb()),2&e){const e=t.$implicit;a.Jb(1),a.uc("value",e.id),a.Jb(1),a.Mc(e.name)}}function f(e,t){if(1&e&&(a.ac(0),a.cc(1,"option",21),a.Lc(2),a.bc(),a.Zb()),2&e){const e=t.$implicit;a.Jb(1),a.uc("value",e.id),a.Jb(1),a.Mc(e.name)}}function m(e,t){if(1&e&&(a.ac(0),a.cc(1,"td"),a.cc(2,"B"),a.Lc(3),a.pc(4,"titlecase"),a.bc(),a.bc(),a.cc(5,"td"),a.Lc(6),a.bc(),a.Zb()),2&e){const e=a.oc().$implicit;a.Jb(3),a.Mc(a.qc(4,2,e.product_name)),a.Jb(3),a.Mc(e.quantity)}}function v(e,t){if(1&e&&(a.cc(0,"tr"),a.Jc(1,m,7,4,"ng-container",23),a.bc()),2&e){const e=t.$implicit;a.Jb(1),a.uc("ngIf",e.quantity>0)}}function y(e,t){if(1&e&&(a.cc(0,"tbody",22),a.Jc(1,v,2,1,"tr",5),a.bc()),2&e){const e=a.oc();a.Jb(1),a.uc("ngForOf",e.reportList)}}function L(e,t){if(1&e&&(a.cc(0,"tbody"),a.cc(1,"tr"),a.cc(2,"td",24),a.Lc(3),a.bc(),a.bc(),a.bc()),2&e){const e=a.oc();a.Jb(3),a.Mc(e.response)}}const S=[{path:"",component:(()=>{class e{constructor(e,t,c,n,i){this.router=e,this.salesService=t,this.userService=c,this.branchService=n,this.ui=i,this.name=[],this.sortOrder=!1,this.sortFields={quantity:!0,food_name:!0},this.reportList=[],this.response="No Data to Show",this.employeeList=[],this.branchList=[],this.selectedPerPage=10,this.currentpage=1,this.getAllEmployee=()=>{this.userService.getAllEmployee().subscribe(e=>{if(e.data){let t=e.data.result.map(e=>({id:e.user_id,name:`${e.f_name} ${e.l_name}`}));this.employeeList=[{id:"",name:"All"},...t]}})},this.getAllBranch=()=>{this.branchService.getBranchList().subscribe(e=>{if(e.data){let t=e.data.map(e=>({id:e.branch_id,name:e.branch_name}));this.branchList=[{id:"",name:"All"},...t]}})},this.onLimitSelect=e=>{this.selectedPerPage=e,this.getAllReport()},this.logout=()=>{localStorage.setItem("isLoggedIn",String(!1)),this.router.navigate(["/login"])}}ngOnInit(){this.getAllReport(),this.getAllBranch(),this.getAllEmployee()}onOptionSelect(e,t){"branch"===e?"ALL"===t?this.selectedEmployee="":this.selectedBranchId=t:"employee"===e&&(this.selectedEmployee="ALL"===t?"":t),this.getAllReport()}getAllReport(){let e={startDate:o(this.selectedStartDate).format("DD-MM-YYYY"),endDate:o(this.selectedEndDate).format("DD-MM-YYYY"),branch_id:this.selectedBranchId,employee_id:this.selectedEmployee},t="";for(let c in e)e[c]&&(t=`${t}${c}=${e[c]}&`);this.ui.loader.show(),this.salesService.getAllProductSalesReport(t).subscribe(e=>{var t,c;if(this.reportList=[],null===(c=null===(t=e)||void 0===t?void 0:t.data)||void 0===c?void 0:c.result){let t=JSON.parse(JSON.stringify(e.data.result)),c=t.map(e=>e.product_id);console.log(c);for(let e=0;e<t.length;e++){let c=t.filter(c=>c.product_id===t[e].product_id);if(console.log(c),c.length>1){let e=JSON.parse(JSON.stringify(c[0])),t=0;for(let n=0;n<c.length;n++)t+=c[n].quantity;e.quantity=t,this.reportList.some(t=>t.product_id===e.product_id)||this.reportList.push(Object.assign({},e))}else this.reportList.push(c[0])}console.log(this.reportList)}this.ui.loader.hide()},e=>{this.ui.loader.hide()})}onDateSelect(){this.selectedStartDate?this.selectedEndDate?this.getAllReport():s.a.fire({icon:"warning",title:"Please Select End Date",showConfirmButton:!1,timer:1500}):s.a.fire({icon:"warning",title:"Please Select Start Date",showConfirmButton:!1,timer:1500})}changeOrder(e){this.sortOrder=!this.sortOrder,this.field=e,this.sortFields[e]=this.sortOrder,this.reportList.sort((t,c)=>"quantity"===e||"quantity"===e?this.sortOrder?c[e]-t[e]:t[e]-c[e]:this.sortOrder?c[e].localeCompare(t[e]):t[e].localeCompare(c[e]))}changedDate(e,t){"start"===e?this.selectedStartDate=t:"end"===e&&(this.selectedEndDate=t),console.log(this.selectedStartDate),console.log(this.selectedEndDate)}}return e.\u0275fac=function(t){return new(t||e)(a.Wb(i.e),a.Wb(l.a),a.Wb(d.a),a.Wb(h.a),a.Wb(u.a))},e.\u0275cmp=a.Qb({type:e,selectors:[["app-product-sales-report"]],viewQuery:function(e,t){var c;1&e&&a.Qc(p,!0),2&e&&a.Bc(c=a.lc())&&(t.closeEditModal=c.first)},decls:41,vars:16,consts:[[1,"container-fluid"],[1,"row","dash-tab"],[1,"col-sm-5","cus-srch"],[1,"form-group"],["name","dev","id","dev",1,"form-control","pl-0",3,"ngModel","ngModelChange","change"],[4,"ngFor","ngForOf"],["name","cars","id","cars",1,"form-control","pl-0",3,"ngModel","ngModelChange","change"],[1,"col-sm-3","cus-srch"],["type","date","id","birthday1","placeholder","From Date","name","selectedSDate",1,"form-control","pl-0",3,"ngModel","ngModelChange","change"],["type","date","id","birthday2","placeholder","To Date","name","selectedEDate",1,"form-control","pl-0",3,"ngModel","ngModelChange","change"],[1,"col-sm-3"],[1,"form-group","mt-3"],[1,"shortcut-btn","w-100",3,"click"],[1,"col-sm-12"],[1,"table-responsive"],[1,"table","details_table"],["scope","col"],["href","javascript:void(0)",1,"caret-sort",3,"click"],[1,"fa"],["style","width:100%",4,"ngIf","ngIfElse"],["elseBlock",""],[3,"value"],[2,"width","100%"],[4,"ngIf"],["colspan","100%",1,"text-center"]],template:function(e,t){if(1&e&&(a.cc(0,"div",0),a.cc(1,"div",1),a.cc(2,"div",2),a.cc(3,"div",3),a.Lc(4," BRANCH WISE "),a.cc(5,"select",4),a.kc("ngModelChange",(function(e){return t.selectedBranchId=e}))("change",(function(e){return t.onOptionSelect("branch",e.target.value)})),a.Jc(6,g,3,2,"ng-container",5),a.bc(),a.bc(),a.bc(),a.cc(7,"div",2),a.cc(8,"div",3),a.Lc(9," EMPLOYEE WISE "),a.cc(10,"select",6),a.kc("ngModelChange",(function(e){return t.selectedEmployee=e}))("change",(function(e){return t.onOptionSelect("employee",e.target.value)})),a.Jc(11,f,3,2,"ng-container",5),a.bc(),a.bc(),a.bc(),a.cc(12,"div",7),a.cc(13,"div",3),a.Lc(14," FROM DATE "),a.cc(15,"input",8),a.kc("ngModelChange",(function(e){return t.selectedStartDate=e}))("change",(function(e){return t.changedDate("start",e.target.value)})),a.bc(),a.bc(),a.bc(),a.cc(16,"div",7),a.cc(17,"div",3),a.Lc(18," TO DATE "),a.cc(19,"input",9),a.kc("ngModelChange",(function(e){return t.selectedEndDate=e}))("change",(function(e){return t.changedDate("end",e.target.value)})),a.bc(),a.bc(),a.bc(),a.cc(20,"div",10),a.cc(21,"div",11),a.cc(22,"button",12),a.kc("click",(function(){return t.onDateSelect()})),a.cc(23,"b"),a.Lc(24,"SEARCH"),a.bc(),a.bc(),a.bc(),a.bc(),a.cc(25,"div",13),a.cc(26,"div",14),a.cc(27,"table",15),a.cc(28,"thead"),a.cc(29,"tr"),a.cc(30,"th",16),a.Lc(31,"Product Name"),a.cc(32,"a",17),a.kc("click",(function(){return t.changeOrder("food_name")})),a.Xb(33,"i",18),a.bc(),a.bc(),a.cc(34,"th",16),a.Lc(35,"Quantity Sold"),a.cc(36,"a",17),a.kc("click",(function(){return t.changeOrder("quantity")})),a.Xb(37,"i",18),a.bc(),a.bc(),a.bc(),a.bc(),a.Jc(38,y,2,1,"tbody",19),a.Jc(39,L,4,1,"ng-template",null,20,a.Kc),a.bc(),a.bc(),a.bc(),a.bc(),a.bc()),2&e){const e=a.Cc(40);a.Jb(5),a.uc("ngModel",t.selectedBranchId),a.Jb(1),a.uc("ngForOf",t.branchList),a.Jb(4),a.uc("ngModel",t.selectedEmployee),a.Jb(1),a.uc("ngForOf",t.employeeList),a.Jb(4),a.uc("ngModel",t.selectedStartDate),a.Jb(4),a.uc("ngModel",t.selectedEndDate),a.Jb(14),a.Nb("fa-caret-down",t.sortFields.food_name)("fa-caret-up",!t.sortFields.food_name),a.Jb(4),a.Nb("fa-caret-down",t.sortFields.quantity)("fa-caret-up",!t.sortFields.quantity),a.Jb(1),a.uc("ngIf",null==t.reportList?null:t.reportList.length)("ngIfElse",e)}},directives:[b.p,b.h,b.k,n.k,b.b,n.l,b.l,b.r],pipes:[n.r],styles:[""]}),e})()}];let D=(()=>{class e{}return e.\u0275mod=a.Ub({type:e}),e.\u0275inj=a.Tb({factory:function(t){return new(t||e)},imports:[[i.h.forChild(S)],i.h]}),e})();c.d(t,"ProductSalesReportModule",(function(){return J}));let J=(()=>{class e{}return e.\u0275mod=a.Ub({type:e}),e.\u0275inj=a.Tb({factory:function(t){return new(t||e)},imports:[[n.b,b.d,D]]}),e})()}}]);